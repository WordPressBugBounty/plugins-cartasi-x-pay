(()=>{"use strict";var e={1020:(e,t,n)=>{var a=n(1609),o=Symbol.for("react.element"),r=Symbol.for("react.fragment"),c=Object.prototype.hasOwnProperty,s=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function i(e,t,n){var a,r={},i=null,u=null;for(a in void 0!==n&&(i=""+n),void 0!==t.key&&(i=""+t.key),void 0!==t.ref&&(u=t.ref),t)c.call(t,a)&&!l.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:o,type:e,key:i,ref:u,props:r,_owner:s.current}}t.Fragment=r,t.jsx=i,t.jsxs=i},1609:e=>{e.exports=window.React},4848:(e,t,n)=>{e.exports=n(1020)}},t={};function n(a){var o=t[a];if(void 0!==o)return o.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,n),r.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var a in t)n.o(t,a)&&!n.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var a=n(1609),o=n.n(a);const r=window.jQuery;var c=n.n(r);const s=window.wc.wcBlocksRegistry,l=window.wp.data,i=window.wp.i18n;var u=n(4848);const p=()=>{const e=wc?.wcSettings?.getSetting("xpay_applepay_button_data",null);if(!e)throw new Error("xpay_applepay_button initialization data is not available");return e},d=()=>{var e;return null!==(e=p()?.can_make_payment)&&void 0!==e&&e},y=()=>{var e;return Object.entries(null!==(e=p()?.content_icons)&&void 0!==e?e:[]).map((([e,{src:t,alt:n}])=>({id:e,src:t,alt:n})))},f=()=>{var e;return null!==(e=p()?.admin_url)&&void 0!==e?e:""},m=({label:e,icons:t,components:n})=>{const{PaymentMethodLabel:a,PaymentMethodIcons:o}=n;return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(a,{text:e}),o&&t.length>0&&(0,u.jsx)(o,{icons:t,align:"right"})]})},v=({eventRegistration:e,emitResponse:t,onSubmit:n,components:a})=>{const{PaymentMethodIcons:r}=a,s=y(),{onPaymentSetup:i,onShippingRateSelectSuccess:p}=e,[d,m]=o().useState(null);o().useEffect((()=>(c()(".wc-block-components-checkout-place-order-button").hide(),()=>{c()(".wc-block-components-checkout-place-order-button").show()})),[]);const v=o().useRef(null),_=o().useRef(null),{validationStore:b}=window.wc.wcBlocksData,w=(0,l.useSelect)((e=>e(b))),h=o().useCallback((()=>{if(!w.hasValidationErrors()){const e={countryCode:d.transactionInfo.countryCode,currencyCode:d.transactionInfo.currencyCode,supportedNetworks:d.cards,merchantCapabilities:["supports3DS"],total:{label:d.config.merchantLabel,amount:d.transactionInfo.totalAmount}},t=new ApplePaySession(14,e);t.onvalidatemerchant=function(e){jQuery.ajax({type:"POST",data:{action:"apple_pay_validate_merchant",validation_url:e.validationURL},url:`${f()}admin-ajax.php`,success:function(e){t.completeMerchantValidation(e)}})},t.onpaymentauthorized=function(e){_.current=e.payment,n(),t.completePayment({status:0})},t.begin()}}),[n,d,w]);o().useEffect((()=>(null!==v.current&&v.current.addEventListener("click",h),()=>{null!==v.current&&v.current.removeEventListener("click",h)})),[h]);const S=o().useCallback(((e,t,n,a)=>o().createElement("apple-pay-button",{buttonstyle:e,type:t,locale:n,ref:a})),[]),x=o().useCallback((()=>{c().ajax({type:"POST",data:{action:"apple_pay_configuration"},url:`${f()}admin-ajax.php`,beforeSend:function(){c().blockUI({message:""})},success:function(e){c().unblockUI(),m(e)},complete:function(){c().unblockUI()}})}),[]);return o().useEffect((()=>{x()}),[x]),o().useEffect((()=>p((()=>(x(),!0)))),[p]),o().useEffect((()=>{const e=i((async()=>({type:t.responseTypes.SUCCESS,meta:{paymentMethodData:{apple_pay_json:JSON.stringify(_.current)}}})));return()=>{e()}}),[t.responseTypes.SUCCESS,t.responseTypes.ERROR,i]),(0,u.jsxs)("div",{class:"class-a",children:[r&&s.length>0&&(0,u.jsx)(r,{contentIcons:s,align:"right"}),(0,u.jsx)("div",{class:"class-b",children:null!==d&&S(d.button_style,d.button_type,d.button_locale,v)})]})};(0,s.registerPaymentMethod)((()=>{const e=null!==(t=p()?.label)&&void 0!==t?t:"";var t;const n=Object.entries(null!==(a=p()?.icons)&&void 0!==a?a:[]).map((([e,{src:t,alt:n}])=>({id:e,src:t,alt:n})));var a;const o=y();var r,c;return{name:"xpay_applepay_button",content:(0,u.jsx)(v,{}),label:(0,u.jsx)(m,{label:e,icons:n}),edit:(0,u.jsx)(v,{content:null!==(c=p()?.content)&&void 0!==c?c:"",icons:o}),icons:n,canMakePayment:d,ariaLabel:(0,i.__)(e,"woocommerce-gateway-nexi-xpay"),supports:{showSavedCards:!1,showSaveOption:!1,features:null!==(r=p()?.features)&&void 0!==r?r:[]}}})())})();