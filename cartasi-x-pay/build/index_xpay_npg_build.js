(()=>{"use strict";var e={1020:(e,t,n)=>{var s=n(1609),r=Symbol.for("react.element"),i=Symbol.for("react.fragment"),a=Object.prototype.hasOwnProperty,o=s.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,c={key:!0,ref:!0,__self:!0,__source:!0};function l(e,t,n){var s,i={},l=null,d=null;for(s in void 0!==n&&(l=""+n),void 0!==t.key&&(l=""+t.key),void 0!==t.ref&&(d=t.ref),t)a.call(t,s)&&!c.hasOwnProperty(s)&&(i[s]=t[s]);if(e&&e.defaultProps)for(s in t=e.defaultProps)void 0===i[s]&&(i[s]=t[s]);return{$$typeof:r,type:e,key:l,ref:d,props:i,_owner:o.current}}t.Fragment=i,t.jsx=l,t.jsxs=l},1609:e=>{e.exports=window.React},4848:(e,t,n)=>{e.exports=n(1020)}},t={};function n(s){var r=t[s];if(void 0!==r)return r.exports;var i=t[s]={exports:{}};return e[s](i,i.exports,n),i.exports}n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},n.d=(e,t)=>{for(var s in t)n.o(t,s)&&!n.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s=n(1609),r=n.n(s);const i=window.jQuery;var a=n.n(i);const o=window.wc.wcBlocksRegistry,c=window.wp.i18n;var l=n(4848);const d=()=>{const e=wc?.wcSettings?.getSetting("xpay_build_data",null);if(!e)throw new Error("xpay_build initialization data is not available");return e},u=()=>{var e;return null!==(e=d()?.can_make_payment)&&void 0!==e&&e},m=()=>{var e;return null!==(e=d()?.content)&&void 0!==e?e:""},p=({label:e,icons:t,components:n})=>{const{PaymentMethodLabel:s,PaymentMethodIcons:r}=n;return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(s,{text:e}),r&&t.length>0&&(0,l.jsx)(r,{icons:t,align:"right"})]})},_=({eventRegistration:e,emitResponse:t})=>{const{onPaymentSetup:n,onCheckoutFail:s,onShippingRateSelectSuccess:i}=e,o=null!==(u=d()?.recurring?.enabled)&&void 0!==u&&u;var u;const p=Object.entries(null!==(_=d()?.all_card_icons)&&void 0!==_?_:[]).map((([e,{src:t,alt:n}])=>({id:e,src:t,alt:n})));var _;const[v,f]=r().useState(void 0),E=r().useCallback((e=>{f(new Build({onBuildSuccess:function(e){"BUILD_SUCCESS"===e.event&&document.getElementById(e.id).classList.remove("with-errors")},onBuildError:function(e){"BUILD_ERROR"===e.event&&document.getElementById(e.id).classList.add("with-errors")},onConfirmError:function(e){"validationStatus"in e&&e.validationStatus.forEach((function(e){document.getElementById(e.id)&&(e.valid?document.getElementById(e.id).classList.remove("with-errors"):document.getElementById(e.id).classList.add("with-errors"))}));const t=new CustomEvent("npg_build_update",{detail:{status:"KO"}});window.dispatchEvent(t)},onBuildFlowStateChange:function(e){if("BUILD_FLOW_STATE_CHANGE"===e.event&&("READY_FOR_PAYMENT"===e.state||"PAYMENT_COMPLETE"===e.state)){const e=new CustomEvent("npg_build_update",{detail:{status:"OK"}});window.dispatchEvent(e)}},cssLink:e}))}),[]),w=r().useCallback((()=>new Promise(((e,t)=>{v.confirmData();const n=s=>{"OK"===s.detail.status?e(s.detail):t(s.detail),window.removeEventListener("npg_build_update",n)};window.addEventListener("npg_build_update",n)}))),[v]),x=r().useCallback((()=>{var e;a().ajax({type:"POST",data:{action:"get_build_fields"},url:`${null!==(e=d()?.admin_url)&&void 0!==e?e:""}admin-ajax.php`,beforeSend:function(){a().blockUI({message:""})},success:function(e){if(a().unblockUI(),e.error_msg)a()(".npg-build-error-msg-container").html(`<p>${e.error_msg}</p>`);else{E(e.cssLink);for(const t of e.fields){const e=document.createElement("iframe");e.src=t.src,e.className="iframe_input";const n=document.getElementById(t.id);if(null!=n)n.innerHTML="",n.appendChild(e);else{const n=document.createElement("div");n.className="form--input__row";const s=document.createElement("div");s.className="form--wrap__row",n.appendChild(s);const r=document.createElement("div");r.id=t.id,r.className="form--input__wrap col-10",s.appendChild(r),r.appendChild(e);const i=document.getElementById("nexi-xpay-extra-fields-container");i&&(i.innerHTML="",i.appendChild(n))}}e.fields.find((function(e){return"CARDHOLDER_SURNAME"===e.id}))?(document.getElementById("CARDHOLDER_NAME").classList.remove("col-10"),document.getElementById("CARDHOLDER_NAME").classList.add("col-5"),document.getElementById("CARDHOLDER_SURNAME").classList.add("col-5")):(document.getElementById("CARDHOLDER_NAME").classList.remove("col-5"),document.getElementById("CARDHOLDER_NAME").classList.add("col-10"),document.getElementById("CARDHOLDER_SURNAME").classList.remove("col-10"))}},complete:function(){a().unblockUI()}})}),[]);return r().useEffect((()=>{x()}),[x]),r().useEffect((()=>i((()=>(x(),!0)))),[i,x]),r().useEffect((()=>s((()=>(x(),!0)))),[s,x]),r().useEffect((()=>{const e=n((async()=>{try{return await w(),{type:t.responseTypes.SUCCESS,meta:{paymentMethodData:{}}}}catch(e){return{type:t.responseTypes.ERROR,message:(0,c.__)("There was an error","woocommerce-gateway-nexi-xpay")}}}));return()=>{e()}}),[t.responseTypes.ERROR,t.responseTypes.SUCCESS,n,w]),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{children:m()}),(0,l.jsx)("div",{class:"nexixpay-loghi-container flex",children:(0,l.jsx)("div",{class:"internal-container",children:p.map((e=>(0,l.jsx)("div",{class:"img-container",children:(0,l.jsx)("img",{src:e.src,alt:e.alt})},e.id)))})}),(0,l.jsxs)("fieldset",{id:"card-fieldset-build",class:"form--fieldset",children:[(0,l.jsx)("div",{class:"form--input__row",children:(0,l.jsx)("div",{class:"form--wrap__row",children:(0,l.jsx)("div",{class:"form--input__wrap col-10",id:"CARD_NUMBER"})})}),(0,l.jsx)("div",{class:"form--input__row",children:(0,l.jsxs)("div",{class:"form--wrap__row",children:[(0,l.jsx)("div",{class:"form--input__wrap col-5",id:"EXPIRATION_DATE"}),(0,l.jsx)("div",{class:"form--input__wrap col-5",id:"SECURITY_CODE"})]})}),(0,l.jsx)("div",{class:"form--input__row",children:(0,l.jsxs)("div",{class:"form--wrap__row",children:[(0,l.jsx)("div",{class:"form--input__wrap",id:"CARDHOLDER_NAME"}),(0,l.jsx)("div",{class:"form--input__wrap",id:"CARDHOLDER_SURNAME"})]})}),(0,l.jsx)("div",{id:"nexi-xpay-extra-fields-container"})]}),(0,l.jsx)("div",{class:"npg-build-error-msg-container"}),o&&(0,l.jsx)("div",{children:(0,l.jsx)("span",{children:null!==(y=d()?.recurring?.disclaimer_text)&&void 0!==y?y:""})})]});var y};(0,o.registerPaymentMethod)((()=>{const e=null!==(t=d()?.label)&&void 0!==t?t:"";var t;const n=Object.entries(null!==(s=d()?.icons)&&void 0!==s?s:[]).map((([e,{src:t,alt:n}])=>({id:e,src:t,alt:n})));var s;const r=Object.entries(null!==(i=d()?.content_icons)&&void 0!==i?i:[]).map((([e,{src:t,alt:n}])=>({id:e,src:t,alt:n})));var i,a,o,v;return{name:"xpay",content:(0,l.jsx)(_,{}),label:(0,l.jsx)(p,{label:e,icons:n}),edit:(0,l.jsx)(_,{content:m(),icons:r}),icons:n,canMakePayment:u,ariaLabel:(0,c.__)(e,"woocommerce-gateway-nexi-xpay"),supports:{showSavedCards:null!==(v=d()?.show_saved_cards)&&void 0!==v&&v,showSaveOption:null!==(o=d()?.show_save_option)&&void 0!==o&&o,features:null!==(a=d()?.features)&&void 0!==a?a:[]}}})())})();